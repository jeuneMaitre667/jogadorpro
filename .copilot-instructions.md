# ğŸ¤– JogadorPro - GitHub Copilot Instructions
**Projet :** JogadorPro | Sports Betting Challenge Platform
**Stack :** Next.js 16, React 19, TypeScript, Tailwind CSS, Supabase, Stripe
**Date :** FÃ©vrier 2026

---

## âš¡ RÃˆGLE NÂ°1 : AUTO-FIX TOUTES LES ERREURS

### TypeScript Errors
- **TOUJOURS** typer les props, states, et retours de fonctions
- **JAMAIS** utiliser `any` â†’ utilise `unknown` puis cast si nÃ©cessaire
- **TOUJOURS** vÃ©rifier que les imports existent avant de les utiliser
- Si une variable n'est pas utilisÃ©e â†’ la supprimer immÃ©diatement
- Si un type est manquant â†’ le crÃ©er dans le mÃªme fichier ou dans `lib/types.ts`

### Import Errors
- **TOUJOURS** vÃ©rifier le chemin relatif avant d'importer
- Utilise ces paths alias :
  ```
  @/components/...  â†’ /components/...
  @/lib/...         â†’ /lib/...
  @/hooks/...       â†’ /hooks/...
  @/data/...        â†’ /data/...
  ```
- Si un module n'existe pas â†’ le crÃ©er avec un export par dÃ©faut vide

### React / Next.js Errors
- **TOUJOURS** ajouter `"use client"` si tu utilises : useState, useEffect, onClick, onChange, event handlers
- **JAMAIS** utiliser `useEffect` sans tableau de dÃ©pendances
- **TOUJOURS** vÃ©rifier que les composants sont exportÃ©s correctement (export default)
- Si une page est un Server Component â†’ pas de hooks, pas d'event handlers
- **TOUJOURS** utiliser `next/link` au lieu de `<a>` pour la navigation interne
- **TOUJOURS** utiliser `next/image` au lieu de `<img>`

### CSS / Tailwind Errors
- **TOUJOURS** utiliser des classes Tailwind existantes uniquement
- **JAMAIS** inventer des classes Tailwind qui n'existent pas
- Pour les couleurs custom, utilise : `text-[#hexcode]` ou `bg-[#hexcode]`
- Pour les tailles custom, utilise : `w-[Xpx]` ou `h-[Xpx]`

### API Route Errors
- **TOUJOURS** wrapper le code dans try/catch
- **TOUJOURS** retourner un status code appropriÃ©
- **TOUJOURS** utiliser `NextResponse.json()`
- Template standard pour toute API route :
  ```typescript
  import { NextResponse } from 'next/server'

  export async function GET(request: Request) {
    try {
      // logic ici
      return NextResponse.json({ success: true, data: result })
    } catch (error) {
      console.error('API Error:', error)
      return NextResponse.json(
        { success: false, error: 'Internal Server Error' },
        { status: 500 }
      )
    }
  }
  ```

---

## ğŸ—ï¸ ARCHITECTURE DU PROJET

### Structure des Dossiers
```
app/
â”œâ”€â”€ (marketing)/          â†’ Pages publiques (landing, pricing)
â”œâ”€â”€ dashboard-pages/      â†’ Pages du dashboard (authentifiÃ©es)
â”‚   â”œâ”€â”€ dashboard/        â†’ Vue principale
â”‚   â”œâ”€â”€ matches/          â†’ Liste des matchs
â”‚   â”œâ”€â”€ my-bets/          â†’ Historique des paris
â”‚   â”œâ”€â”€ challenge-status/ â†’ Suivi du challenge
â”‚   â”œâ”€â”€ create-challenge/ â†’ CrÃ©er un challenge
â”‚   â””â”€â”€ settings/         â†’ ParamÃ¨tres
â”œâ”€â”€ api/                  â†’ Routes API backend
â”‚   â”œâ”€â”€ matches/          â†’ API matchs (Odds API)
â”‚   â”œâ”€â”€ challenges/       â†’ API challenges
â”‚   â”œâ”€â”€ picks/            â†’ API paris
â”‚   â””â”€â”€ stripe/           â†’ API paiements
â”œâ”€â”€ auth/                 â†’ Pages d'authentification
â”œâ”€â”€ checkout/             â†’ Page checkout Stripe
â””â”€â”€ affiliate/            â†’ Programme d'affiliation

components/
â”œâ”€â”€ ui/                   â†’ Composants UI rÃ©utilisables (shadcn)
â”œâ”€â”€ sections/             â†’ Sections de la landing page
â”œâ”€â”€ dashboard/            â†’ Composants du dashboard
â””â”€â”€ shared/               â†’ Composants partagÃ©s

hooks/                    â†’ Custom React hooks
â”œâ”€â”€ useMatches.ts         â†’ RÃ©cupÃ©ration des matchs
â”œâ”€â”€ useChallenge.ts       â†’ Gestion du challenge
â””â”€â”€ useTranslation.ts     â†’ Multi-langue

lib/                      â†’ Utilitaires et services
â”œâ”€â”€ supabase.ts           â†’ Client Supabase
â”œâ”€â”€ oddsapi.ts            â†’ Service Odds API
â”œâ”€â”€ sportsConfig.ts       â†’ Config des ligues
â””â”€â”€ types.ts              â†’ Types TypeScript globaux

data/                     â†’ DonnÃ©es statiques et config
```

### Naming Conventions
- **Fichiers de composants** : PascalCase â†’ `MyComponent.tsx`
- **Fichiers de pages** : lowercase â†’ `page.tsx`
- **Fichiers de hooks** : camelCase avec `use` â†’ `useMatches.ts`
- **Fichiers de utils** : camelCase â†’ `formatDate.ts`
- **Fichiers de types** : camelCase â†’ `types.ts`
- **CSS classes** : Tailwind uniquement, pas de CSS custom sauf si nÃ©cessaire

---

## ğŸ¨ DESIGN SYSTEM

### Couleurs de Marque
```
Primary Green     : #10b981 (emerald-500)
Primary Dark      : #059669 (emerald-600)
Secondary Blue    : #3b82f6 (blue-500)
Background Dark   : #0f172a (slate-900)
Background Card   : #1e293b (slate-800)
Background Lighter: #334155 (slate-700)
Text Primary      : #f1f5f9 (slate-100)
Text Secondary    : #94a3b8 (slate-400)
Text Muted        : #64748b (slate-500)
Success           : #10b981 (emerald-500)
Error             : #ef4444 (red-500)
Warning           : #f59e0b (amber-500)
Info              : #3b82f6 (blue-500)
```

### Gradient de Marque
```css
/* Gradient principal */
from-emerald-500 to-blue-500

/* Gradient sombre (backgrounds) */
from-slate-900 via-slate-800 to-slate-900

/* Gradient card hover */
from-emerald-500/10 to-blue-500/10
```

### Spacing & Layout
```
Sidebar width     : 80px (icÃ´nes) ou 240px (avec texte)
Card padding      : p-4 ou p-6
Section gap       : gap-4 ou gap-6
Border radius     : rounded-lg (8px) par dÃ©faut
Shadow cards      : shadow-lg
```

### Composants Standard
```typescript
// Bouton primaire
<button className="bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-6 rounded-lg transition-colors duration-200">

// Bouton secondaire
<button className="border border-slate-600 hover:border-emerald-500 text-slate-300 hover:text-white py-2 px-6 rounded-lg transition-colors duration-200">

// Card standard
<div className="bg-slate-800 border border-slate-700 rounded-lg p-6 hover:border-emerald-500 transition-colors duration-200">

// Badge
<span className="bg-emerald-500/10 text-emerald-400 text-xs font-semibold px-2 py-1 rounded-full">

// Input standard
<input className="bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:border-emerald-500 focus:outline-none transition-colors" />
```

---

## ğŸ” AUTHENTIFICATION & SÃ‰CURITÃ‰

### RÃ¨gles Auth
- **TOUJOURS** vÃ©rifier l'authentification avant d'afficher le dashboard
- **TOUJOURS** utiliser Supabase Auth pour la gestion des sessions
- **JAMAIS** exposer les API keys dans le code client
- Les variables avec `NEXT_PUBLIC_` sont visibles client-side
- Les autres variables sont uniquement server-side

### Middleware Auth
```typescript
// Toujours vÃ©rifier la session avant d'accÃ©der aux pages protÃ©gÃ©es
import { createMiddlewareClient } from '@supabase/auth-helpers-nextjs'

const supabase = createMiddlewareClient({ req, res })
const { data: { session } } = await supabase.auth.getSession()

if (!session) {
  return NextResponse.redirect(new URL('/auth/login', request.url))
}
```

---

## ğŸ’° STRIPE INTEGRATION

### RÃ¨gles Stripe
- **TOUJOURS** utiliser `stripe.js` pour les paiements client-side
- **TOUJOURS** crÃ©er les sessions sur le server-side (API routes)
- **JAMAIS** exposer la clÃ© secret Stripe
- **TOUJOURS** valider les webhooks avec la signature

### Challenge Tiers (Prices)
```
DEMO     : Gratuit    | Capital: â‚¬100
STARTER  : â‚¬297       | Capital: R$ 10,000
STANDARD : â‚¬597       | Capital: R$ 25,000 (POPULAR)
PRO      : â‚¬997       | Capital: R$ 50,000
ELITE    : â‚¬1,797     | Capital: R$ 100,000
```

---

## ğŸ“Š ODDS API INTEGRATION

### RÃ¨gles Odds API
- **TOUJOURS** utiliser le cache (minimum 1 heure)
- **TOUJOURS** vÃ©rifier le rate limit avant de faire une requÃªte
- **TOUJOURS** gÃ©rer les erreurs de l'API extÃ©rieure
- **JAMAIS** appeler l'API directement depuis le client â†’ toujours via `/api/matches`

### Cache Strategy
```typescript
// Cache minimum 1h pour respecter le rate limit
const CACHE_DURATION = 60 * 60 * 1000 // 1 heure

// Toujours vÃ©rifier le cache AVANT de faire une requÃªte API
const cached = await getFromCache('matches')
if (cached && !isExpired(cached)) return cached
```

---

## ğŸ—„ï¸ SUPABASE / DATABASE

### RÃ¨gles Database
- **TOUJOURS** utiliser les types gÃ©nÃ©rÃ©s par Supabase
- **TOUJOURS** gÃ©rer les erreurs de requÃªte
- **TOUJOURS** utiliser Row Level Security (RLS)
- **JAMAIS** faire de requÃªtes raw SQL depuis le client

### Tables Principales
```
users          â†’ Gestion utilisateurs (via Supabase Auth)
challenges     â†’ Challenges actifs/complÃ©tÃ©s
picks          â†’ Paris placÃ©s par les utilisateurs
payouts        â†’ Payouts effectuÃ©s
affiliates     â†’ Programme d'affiliation
```

---

## âœ… CHECKLIST AVANT CHAQUE COMMIT

- [ ] 0 erreurs TypeScript (`npm run build` passe)
- [ ] Tous les imports sont corrects
- [ ] Pas de `console.log` en dehors du dÃ©veloppement
- [ ] Les composants sont typÃ©s correctement
- [ ] Les API routes ont try/catch
- [ ] Les pages client ont `"use client"` si nÃ©cessaire
- [ ] Le design suit le Design System (couleurs, spacing, etc.)
- [ ] Les variables d'environnement ne sont pas exposÃ©es

---

## ğŸ› ERREURS COURANTES & SOLUTIONS

### 1. "Module not found"
```
âŒ Erreur : Cannot find module '@/components/X'
âœ… Solution : VÃ©rifie que le fichier existe dans /components/X.tsx
            VÃ©rifie que tsconfig.json a les paths configurÃ©s
```

### 2. "useEffect has missing dependencies"
```
âŒ Erreur : React Hook useEffect has missing dependencies
âœ… Solution : Ajoute les dÃ©pendances manquantes dans le tableau []
            OU utilise useCallback pour les fonctions
```

### 3. "'use client' missing"
```
âŒ Erreur : Event handlers cannot be passed as props to Server Components
âœ… Solution : Ajoute "use client" en haut du fichier du composant
```

### 4. "Cannot read properties of undefined"
```
âŒ Erreur : Cannot read properties of undefined (reading 'X')
âœ… Solution : Ajoute optional chaining â†’ obj?.property
            OU vÃ©rifie que la donnÃ©e est chargÃ©e avant d'utiliser
```

### 5. "Hydration mismatch"
```
âŒ Erreur : Expected server HTML to contain a matching X
âœ… Solution : Utilise dynamic import avec { ssr: false }
            OU utilise useState + useEffect pour charger le composant
```

### 6. "NEXT_PUBLIC variable undefined"
```
âŒ Erreur : Variable d'env undefined en production
âœ… Solution : Ajoute la variable dans Vercel â†’ Settings â†’ Environment Variables
            VÃ©rifie que elle commence par NEXT_PUBLIC_ si utilisÃ©e client-side
```

### 7. "Supabase connection error"
```
âŒ Erreur : Could not connect to Supabase
âœ… Solution : VÃ©rifie NEXT_PUBLIC_SUPABASE_URL dans .env.local
            VÃ©rifie que le projet Supabase est actif
```

### 8. "Too many re-renders"
```
âŒ Erreur : Maximum update depth exceeded
âœ… Solution : VÃ©rifie que setState n'est pas appelÃ© dans le render
            Utilise useMemo ou useCallback pour les valeurs/fonctions
```

---

## ğŸ“ STYLE DE CODE

### Conventions
- **Indentation** : 2 spaces
- **Semicolons** : Oui, toujours
- **Quotes** : Double quotes pour JSX, single quotes pour JS/TS
- **Trailing commas** : Oui
- **Arrow functions** : PrÃ©fÃ©rÃ©es aux function declarations pour les composants
- **Exports** : export default pour les pages, named exports pour les utilitaires

### Exemple de Composant Parfait
```typescript
"use client";

import { useState, useEffect } from "react";
import { useRouter } from "next/navigation";
import type { FC } from "react";

interface Props {
  title: string;
  items: Array<{
    id: string;
    name: string;
    value: number;
  }>;
  onSelect?: (id: string) => void;
}

const MyComponent: FC<Props> = ({ title, items, onSelect }) => {
  const [selected, setSelected] = useState<string | null>(null);
  const router = useRouter();

  useEffect(() => {
    console.log("Component mounted");
    return () => {
      console.log("Component unmounted");
    };
  }, []);

  const handleSelect = (id: string) => {
    setSelected(id);
    onSelect?.(id);
  };

  return (
    <div className="bg-slate-800 border border-slate-700 rounded-lg p-6">
      <h2 className="text-white font-semibold text-lg mb-4">{title}</h2>
      <div className="flex flex-col gap-2">
        {items.map((item) => (
          <button
            key={item.id}
            onClick={() => handleSelect(item.id)}
            className={`p-3 rounded-lg text-left transition-colors duration-200 ${
              selected === item.id
                ? "bg-emerald-500/10 border border-emerald-500 text-emerald-400"
                : "bg-slate-700 border border-slate-600 text-slate-300 hover:border-emerald-500"
            }`}
          >
            <span className="font-medium">{item.name}</span>
            <span className="text-slate-400 ml-2">R$ {item.value.toLocaleString()}</span>
          </button>
        ))}
      </div>
    </div>
  );
};

export default MyComponent;
```

---

## ğŸš€ PERFORMANCE

### RÃ¨gles de Performance
- **TOUJOURS** lazy load les composants lourds avec `dynamic()`
- **TOUJOURS** optimiser les images avec `next/image`
- **TOUJOURS** mÃ©moiser les composants qui re-render souvent avec `React.memo`
- **TOUJOURS** utiliser `useMemo` pour les calculs lourds
- **TOUJOURS** utiliser `useCallback` pour les fonctions passÃ©es comme props
- **JAMAIS** faire de requÃªtes API dans le render directement

### Code Splitting
```typescript
// Lazy load des composants lourds
import dynamic from 'next/dynamic';

const HeavyComponent = dynamic(() => import('./HeavyComponent'), {
  loading: () => <div className="text-slate-400">Loading...</div>,
  ssr: false // Si le composant utilise window/document
});
```

---

## ğŸŒ INTERNATIONALISATION

### Langues SupportÃ©es
```
ğŸ‡§ğŸ‡· PortuguÃªs (Brasileiro) â†’ Par dÃ©faut
ğŸ‡«ğŸ‡· FranÃ§ais
ğŸ‡¬ğŸ‡§ English
```

### RÃ¨gles i18n
- **TOUJOURS** utiliser `useTranslation()` hook pour les textes
- **JAMAIS** hardcoder des textes en franÃ§ais ou anglais dans les composants
- Les donnÃ©es API peuvent rester en anglais (matchs, leagues, etc.)
- Les prix se displayed en R$ (Reais) par dÃ©faut

---

*ğŸ“„ Ce fichier doit Ãªtre placÃ© Ã  la racine du projet : `.copilot-instructions.md`*
*ğŸ”„ Mis Ã  jour rÃ©guliÃ¨rement avec les nouvelles conventions du projet*
*ğŸ“Œ DerniÃ¨re mise Ã  jour : 2 fÃ©vrier 2026*
